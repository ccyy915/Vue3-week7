{"version":3,"sources":["webpack:///./src/views/Dashboard/Orders.vue","webpack:///./src/components/OrderModal.vue","webpack:///./src/components/OrderModal.vue?ab11","webpack:///./src/views/Dashboard/Orders.vue?0104"],"names":["class","width","active","isLoading","orders","item","key","id","time","create_at","user","name","tel","email","total","type","is_paid","updatePaid","for","openModal","openDelOrderModal","order","tempOrder","ref","delOrder","pages","pagination","getOrders","tabindex","role","aria-labelledby","aria-hidden","data-bs-dismiss","aria-label","style","address","paid_date","products","product","title","qty","unit","final_total","value","$emit","props","Object","default","data","statuts","modal","isPaid","emits","infect","watch","this","methods","show","hideModal","hide","timestamp","format","mounted","$refs","render","idLoading","currentPage","components","OrderModal","DelModal","Pagination","created","url","$http","get","then","res","success","isNew","orderComponent","orderModal","delOrderComponent","delModal","delete","paid","put","alert","message"],"mappings":"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","file":"js/chunk-2d0d07e5.e9764892.js","sourcesContent":["<template>\n  <Loading :active=\"isLoading\"></Loading>\n  <div class=\"row justify-content-center\">\n    <div class=\"col-md-10\">\n      <table class=\"table mt-4\">\n        <thead>\n          <tr>\n            <th width=\"120\">成立日期</th>\n            <th>收件人姓名</th>\n            <th width=\"120\">收件人電話</th>\n            <th>收件人信箱</th>\n            <th width=\"120\">總金額</th>\n            <th width=\"120\">是否付款</th>\n            <th width=\"120\">編輯</th>\n          </tr>\n        </thead>\n        <tbody>\n          <tr v-for=\"item in orders\" :key=\"item.id\">\n            <td>{{ time(item.create_at) }}</td>\n            <td>{{ item.user.name }}</td>\n            <td>{{ item.user.tel }}</td>\n            <td>{{ item.user.email }}</td>\n            <td>{{ item.total }}</td>\n            <td>\n              <div class=\"form-check form-switch\">\n                <input\n                  class=\"form-check-input\"\n                  type=\"checkbox\"\n                  :id=\"`paidSwitch${item.id}`\"\n                  v-model=\"item.is_paid\"\n                  @change=\"updatePaid(item)\"\n                />\n                <label class=\"form-check-label\" :for=\"`paidSwitch${item.id}`\">\n                  <span v-if=\"item.is_paid\" class=\"text-success\">已付款</span>\n                  <span v-else>未付款</span>\n                </label>\n              </div>\n            </td>\n            <td>\n              <div class=\"btn-group\">\n                <button\n                  class=\"btn btn-outline-primary btn-sm\"\n                  type=\"button\"\n                  @click=\"openModal(item)\"\n                >\n                  檢視\n                </button>\n                <button\n                  class=\"btn btn-outline-danger btn-sm\"\n                  type=\"button\"\n                  @click=\"openDelOrderModal(item)\"\n                >\n                  刪除\n                </button>\n              </div>\n            </td>\n          </tr>\n        </tbody>\n      </table>\n      <OrderModal\n        :order=\"tempOrder\"\n        ref=\"orderModal\"\n        @update-paid=\"updatePaid\"\n      ></OrderModal>\n      <DelModal\n        :item=\"tempOrder\"\n        ref=\"delModal\"\n        @delete-data=\"delOrder\"\n      ></DelModal>\n      <Pagination :pages=\"pagination\" @emitPages=\"getOrders\"></Pagination>\n    </div>\n  </div>\n</template>\n\n<script>\nimport moment from \"moment\";\nimport OrderModal from \"@/components/OrderModal.vue\";\nimport DelModal from \"@/components/DeleteModal.vue\";\nimport Pagination from \"@/components/Pagination.vue\";\n\nexport default {\n  name: \"Orders\",\n  props: [\"token\"],\n  data() {\n    return {\n      idLoading: false,\n      orders: {},\n      tempOrder: {},\n      pagination: {},\n      currentPage: 1,\n    };\n  },\n  components: {\n    OrderModal,\n    DelModal,\n    Pagination,\n  },\n  created() {\n    this.getOrders();\n  },\n  methods: {\n    getOrders(currentPage = 1) {\n      this.currentPage = currentPage;\n      this.isLoading = true;\n      const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/admin/orders?page=${currentPage}`;\n      this.$http.get(url).then((res) => {\n        if (res.data.success) {\n          this.isLoading = false;\n          this.orders = res.data.orders;\n          this.pagination = res.data.pagination;\n        }\n      });\n    },\n    time(timestamp) {\n      return moment(timestamp * 1000).format(\"YYYY-MM-DD\");\n    },\n    openModal(item) {\n      this.tempOrder = { ...item };\n      this.isNew = false;\n      const orderComponent = this.$refs.orderModal;\n      orderComponent.openModal();\n    },\n    openDelOrderModal(item) {\n      this.tempOrder = { ...item };\n      const delOrderComponent = this.$refs.delModal;\n      delOrderComponent.openModal();\n    },\n    delOrder() {\n      const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/admin/order/${this.tempOrder.id}`;\n      this.isLoading = true;\n      this.$http.delete(url).then(() => {\n        const delOrderComponent = this.$refs.delModal;\n        delOrderComponent.hideModal();\n        this.getOrders(this.currentPage);\n      });\n    },\n    updatePaid(item) {\n      this.isLoading = true;\n      const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/admin/order/${item.id}`;\n      const paid = {\n        is_paid: item.is_paid,\n      };\n      this.$http.put(url, { data: paid }).then((res) => {\n        this.isLoading = false;\n        const orderComponent = this.$refs.orderModal;\n        orderComponent.hideModal();\n        this.getOrders(this.currentPage);\n        alert(res.data.message);\n      });\n    },\n  },\n};\n</script>\n","<template>\n  <div\n    class=\"modal fade\"\n    id=\"productModal\"\n    tabindex=\"-1\"\n    role=\"dialog\"\n    aria-labelledby=\"exampleModalLabel\"\n    aria-hidden=\"true\"\n    ref=\"modal\"\n  >\n    <div class=\"modal-dialog modal-xl modal-dialog-centered\" role=\"document\">\n      <div class=\"modal-content border-0\">\n        <div class=\"modal-header\">\n          <h5 class=\"modal-title\" id=\"exampleModalLabel\">\n            <span>訂單細節</span>\n          </h5>\n          <button\n            type=\"button\"\n            class=\"btn-close\"\n            data-bs-dismiss=\"modal\"\n            aria-label=\"Close\"\n          ></button>\n        </div>\n        <div class=\"modal-body\">\n          <div class=\"row\">\n            <div class=\"col-md-4\">\n              <h3>用戶資料</h3>\n              <table class=\"table\">\n                <tbody v-if=\"tempOrder.user\">\n                  <tr>\n                    <th style=\"width: 100px\">姓名</th>\n                    <td>{{ tempOrder.user.name }}</td>\n                  </tr>\n                  <tr>\n                    <th>Email</th>\n                    <td>{{ tempOrder.user.email }}</td>\n                  </tr>\n                  <tr>\n                    <th>電話</th>\n                    <td>{{ tempOrder.user.tel }}</td>\n                  </tr>\n                  <tr>\n                    <th>地址</th>\n                    <td>{{ tempOrder.user.address }}</td>\n                  </tr>\n                </tbody>\n              </table>\n            </div>\n            <div class=\"col-md-8\">\n              <h3>訂單細節</h3>\n              <table class=\"table\">\n                <tbody>\n                  <tr>\n                    <th style=\"width: 100px\">訂單編號</th>\n                    <td>{{ tempOrder.id }}</td>\n                  </tr>\n                  <tr>\n                    <th>下單時間</th>\n                    <td>{{ time(tempOrder.create_at) }}</td>\n                  </tr>\n                  <tr>\n                    <th>付款時間</th>\n                    <td>\n                      <span v-if=\"tempOrder.paid_date\">\n                        {{ time(tempOrder.paid_date) }}\n                      </span>\n                      <span v-else>-</span>\n                    </td>\n                  </tr>\n                  <tr>\n                    <th>付款狀態</th>\n                    <td>\n                      <strong v-if=\"tempOrder.is_paid\" class=\"text-success\"\n                        >已付款</strong\n                      >\n                      <span v-else class=\"text-muted\">尚未付款</span>\n                    </td>\n                  </tr>\n                  <tr>\n                    <th>總金額</th>\n                    <td>\n                      {{ tempOrder.total }}\n                    </td>\n                  </tr>\n                </tbody>\n              </table>\n              <h3>選購商品</h3>\n              <table class=\"table\">\n                <thead>\n                  <tr></tr>\n                </thead>\n                <tbody>\n                  <tr v-for=\"item in tempOrder.products\" :key=\"item.id\">\n                    <th>\n                      {{ item.product.title }}\n                    </th>\n                    <td>{{ item.qty }} / {{ item.product.unit }}</td>\n                    <td class=\"text-end\">\n                      {{ item.final_total }}\n                    </td>\n                  </tr>\n                </tbody>\n              </table>\n              <div class=\"d-flex justify-content-end\">\n                <div class=\"form-check\">\n                  <input\n                    class=\"form-check-input\"\n                    type=\"checkbox\"\n                    value=\"\"\n                    id=\"flexCheckDefault\"\n                    v-model=\"tempOrder.is_paid\"\n                  />\n                  <label class=\"form-check-label\" for=\"flexCheckDefault\">\n                    <span v-if=\"tempOrder.is_paid\" class=\"text-success\">已付款</span>\n                    <span v-else>未付款</span>\n                  </label>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n        <div class=\"modal-footer\">\n          <button\n            type=\"button\"\n            class=\"btn btn-outline-secondary\"\n            data-bs-dismiss=\"modal\"\n          >\n            取消\n          </button>\n          <button\n            type=\"button\"\n            class=\"btn btn-primary\"\n            @click=\"$emit('update-paid', tempOrder)\"\n          >\n            修改付款狀態\n          </button>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport moment from \"moment\";\nimport Modal from \"bootstrap/js/dist/modal\";\n\nexport default {\n  props: {\n    order: {\n      type: Object,\n      default() {\n        return {};\n      },\n    },\n  },\n  data() {\n    return {\n      statuts: {},\n      modal: \"\",\n      tempOrder: {},\n      isPaid: false,\n    };\n  },\n  emits: [\"update-paid\"],\n  infect: [\"emitter\"],\n  watch: {\n    order() {\n      this.tempOrder = this.order;\n    },\n  },\n  methods: {\n    openModal() {\n      this.modal.show();\n    },\n    hideModal() {\n      this.modal.hide();\n    },\n    time(timestamp) {\n      return moment(timestamp * 1000).format(\"YYYY-MM-DD\");\n    },\n  },\n  mounted() {\n    this.modal = new Modal(this.$refs.modal);\n  },\n};\n</script>\n","import { render } from \"./OrderModal.vue?vue&type=template&id=601e62d2\"\nimport script from \"./OrderModal.vue?vue&type=script&lang=js\"\nexport * from \"./OrderModal.vue?vue&type=script&lang=js\"\nscript.render = render\n\nexport default script","import { render } from \"./Orders.vue?vue&type=template&id=7aae8b80\"\nimport script from \"./Orders.vue?vue&type=script&lang=js\"\nexport * from \"./Orders.vue?vue&type=script&lang=js\"\nscript.render = render\n\nexport default script"],"sourceRoot":""}